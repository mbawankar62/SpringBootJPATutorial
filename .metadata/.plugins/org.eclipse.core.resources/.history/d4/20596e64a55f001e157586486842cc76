package com.hibernate.demo;

import java.util.List;

import org.hibernate.Session;
import org.hibernate.Transaction;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

import com.hibernate.demo.entity.Student;
import com.hibernate.demo.entity.Util.HibernateUtil;

@SpringBootApplication
public class HibernateDemoApplication {

	public static void main(String[] args) {
		SpringApplication.run(HibernateDemoApplication.class, args);
		
		Student student = new Student("Ramesh", "Fadatare", "rameshfadatare@javaguides.com");
	    Student student1 = new Student("John", "Cena", "john@javaguides.com");
	    Transaction transaction = null;
	    
	    try (Session session = HibernateUtil.getSessionFactory().openSession()) {
	        // start a transaction
	        transaction = session.beginTransaction();
	        // save the student objects
	        session.persist(student);
	        session.persist(student1);
	        // commit transaction
	        transaction.commit();
	    } catch (Exception e) {
	        if (transaction != null) {
	            transaction.rollback();
	        }
	        e.printStackTrace();
	    }

	    try (Session session2 = HibernateUtil.getSessionFactory().openSession()) {
	        List < Student > students = session.createQuery("from Student", Student.class).list();
	        students.forEach(s - > System.out.println(s.getFirstName()));
	    } catch (Exception ex) {
	        if (transaction != null) {
	            transaction.rollback();
	        }
	        ex.printStackTrace();
	    }
	}
	}

	
}
